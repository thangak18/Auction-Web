{{#section 'js'}}
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  document.getElementById("formForgotPassword").addEventListener("submit", function (event) {
    event.preventDefault();

    const email = document.getElementById("email").value.trim();
    if (email === "") {
      Swal.fire({
        icon: 'error',
        title: 'Error',
        text: 'Please enter your email address.'
      });
      return;
    }

    // UX: Disable button & show loading state
    const btnSubmit = event.target.querySelector('button[type="submit"]');
    const originalText = btnSubmit.innerHTML;
    btnSubmit.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Sending OTP...';
    btnSubmit.disabled = true;

    event.target.submit();
  });
</script>
{{/section}}

<section class="py-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-6">

        <!-- Title -->
        <div class="mb-4 text-center">
          <h2 class="text-uppercase">Forgot Password</h2>
          <p class="text-muted mb-0">
            Enter your email address to receive an <strong>OTP code</strong> for password reset.
          </p>
        </div>

        {{!-- Global messages from controller --}}
        {{#if error_message}}
        <div class="alert alert-danger">
          {{error_message}}
        </div>
        {{/if}}

        {{#if success_message}}
        <div class="alert alert-success">
          {{success_message}}
        </div>
        {{/if}}

        <form method="post" action="/account/forgot-password" id="formForgotPassword">
          <!-- Email -->
          <div class="mb-4">
            <label for="email" class="form-label text-uppercase small">Email Address</label>
            <input
              type="email"
              class="form-control {{#if error_message}}is-invalid{{/if}}"
              id="email"
              name="email"
              placeholder="you@example.com"
              value="{{email}}" 
              autofocus>
          </div>

          <!-- Submit -->
          <div class="d-grid mb-3">
            <button type="submit" class="btn btn-dark text-uppercase">
              Get OTP
            </button>
          </div>

          <!-- Back to Sign In -->
          <div class="text-center">
            <a href="/account/signin" class="text-decoration-none text-muted small">
              <i class="bi bi-arrow-left"></i> Back to Sign in
            </a>
          </div>
        </form>

      </div>
    </div>
  </div>
</section>